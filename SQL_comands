-- команды для работы в SQL

psql postgres -- подключаешься к дефолтной базе данных постгрес.
CREATE DATABASE hexlet_db; -- тчк с запятой обязательно, это завершение команды.
psql hexlet_db -- подключаемся к бд hexlet_db.

-- создаем таблицу командой
-- все имена используются как пример

CREATE TABLE users (
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    email VARCHAR(255),
    created_at TIMESTAMP,
    birthday DATE
);

-- добавление пользователей в таблицу

INSERT INTO users
(first_name,  last_name, email, created_at, birthday)
VALUES ('Lucienne', 'Feil',  'Trevion53@yahoo.com', '2022-06-14 18:31:05.296', '2017-08-03');

INSERT INTO users
(first_name,  last_name, email, created_at, birthday)
VALUES ('Ramiro', 'Wolf',  'Baylee52@yahoo.com', '2022-06-14 02:04:13.104', '2000-03-23');

INSERT INTO users
(first_name,  last_name, email, created_at, birthday)
VALUES ('Maureen', 'Romaguera',  'Casimer_Cronin@yahoo.com', '2022-06-14 02:28:26.058', '2012-07-30');

-- что бы увидеть все таблицы \dt, затем \d имя_таблицы что бы увидеть ее структуру.

-- запрост на редактирование записи
UPDATE users SET email = 'Casimer_Cronin@gmail.com'
WHERE last_name = 'Romaguera';

-- удалени записи
DELETE FROM users WHERE last_name = 'Romaguera';

-- выбрать запись
SELECT * FROM users WHERE first_name = 'Ramiro';

-- удаление таблиц
DROP TABLE users;

-- "--" два дефиса это однострочный коментарий
/* и */ это для многострочных коментариев

-- Утилита PSQL
-- подключение к БД с помощью psql
psql -h server_address -U username -d dbname

-- урок 6
-- примеры
CREATE TABLE students (
    id BIGINT,
    first_name VARCHAR(255),
    last_name VARCHAR(255),
    email VARCHAR(255),
    bio TEXT,
    is_studying BOOLEAN,
    updated_at TIMESTAMP,
    created_at TIMESTAMP
  );
-- решение задачи
CREATE TABLE events (
   id BIGINT,
   name VARCHAR(50),
   date DATE, time TIME,
   location VARCHAR(100),
   description TEXT);


-- урок 7
CREATE TABLE users (
    id BIGINT PRIMARY KEY,
    username VARCHAR(50),
    email VARCHAR(255),
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    created_at TIMESTAMP
);

-- Наполняем таблицу данными
INSERT INTO users (id, created_at, email, first_name, last_name, username) VALUES (1, '2022-06-14 18:31:05.296', 'Trevion53@yahoo.com', 'Lucienne', 'Feil', 'Duncan3');
INSERT INTO users (id, created_at, email, first_name, last_name, username) VALUES (2, '2022-06-14 02:04:13.104', 'Baylee52@yahoo.com', 'Ramiro', 'Wolf', 'Michaela11');

-- создаем таблицу с автоинкрементом
CREATE TABLE users (
    id BIGINT GENERATED ALWAYS AS IDENTITY,
    username VARCHAR(50),
    email VARCHAR(255),
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    created_at TIMESTAMP
);

-- Основной ключ и автоинкремент часто используются вместе

CREATE TABLE users (
    id BIGINT PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
    username VARCHAR(50),
    email VARCHAR(255),
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    created_at TIMESTAMP
);

-- Просмотреть все записи (полностью)
SELECT * FROM users;

CREATE TABLE users (
    -- Одновременное использование и первичного ключа и автогенерации
    id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    username VARCHAR(50),
    email VARCHAR(255),
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    created_at TIMESTAMP
);

-- задание к уроку 7
CREATE TABLE article_categories (
    id BIGINT PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
    name VARCHAR(50)
    );
INSERT INTO article_categories (name) VALUES ('Dave Grohl');
INSERT INTO article_categories (name) VALUES ('Kurt Cobain');

-- урок 8
SELECT * FROM users; -- Этот запрос достает все содержимое таблицы users.
SELECT username, email FROM users; --Если поля нужны не все, то достаточно перечислить их через запятую вместо звездочки.

-- практическое задание к уроку
/*Составьте запрос, который извлекает из таблицы companies:
company_name — названия компаний
url — адрес компаний в интернете*/

SELECT company_name, url FROM companies;

-- Урок 9
-- SELECT * FROM users WHERE ... Чтобы выбрать строки, которые нам нужны используют оператор WHERE
-- В запросе SELECT его нужно добавить и после него задать нужное нам условие.
-- SELECT * FROM users WHERE id > 60;
-- SELECT * FROM users WHERE id = 1;
-- SELECT * FROM users WHERE id != 3;
-- SELECT * FROM users WHERE first_name = 'Johan';
-- SELECT name, created_at FROM courses WHERE created_at > '2022-06-14';

-- выполнение практического задания

SELECT first_name, last_name FROM users WHERE birthday <= '2000-01-01';

-- урок 10 NULL

--SELECT * FROM users WHERE birthday IS NOT NULL;
--SELECT * FROM users WHERE created_at IS NULL;

-- Урок 11 примеры
SELECT id, first_name, last_name, email, birthday FROM users WHERE last_name = 'Schumm';
SELECT id, first_name, last_name, email, birthday FROM users WHERE last_name LIKE 'Sch%';
SELECT id, first_name, last_name, email, birthday FROM users WHERE last_name LIKE 'Sch%';
SELECT id, first_name, last_name, email, birthday FROM users WHERE last_name LIKE '%man';
SELECT id, first_name, last_name, email, birthday FROM users WHERE last_name LIKE 'Sch%t';
SELECT id, first_name, last_name, email, birthday FROM users WHERE last_name LIKE 'sch%t';
SELECT id, first_name, last_name, email, birthday FROM users WHERE last_name ILIKE 'sch%t'; -- регистр не имеет значение
SELECT id, first_name, last_name, email, birthday FROM users WHERE last_name NOT LIKE '%man';

-- задание из урока
SELECT first_name, last_name, email FROM users WHERE email LIKE '%google.com';

--Урок 12 (Регулярные выражения)
SELECT
    id,
    first_name,
    last_name,
    email,
    birthday
FROM users
WHERE first_name SIMILAR TO '[AB]%';

WHERE first_name SIMILAR TO '[AB]%'; -- выбрать пользователей, чье имя начинается на 'A' или 'B
WHERE username SIMILAR TO '%[a-z]'; -- вернет всех пользователей по условию: username заканчивается любой буквой
WHERE username SIMILAR TO '%[а-я]%' -- вернет всех пользователей по условию: username заканчивается любой буквой
WHERE username SIMILAR TO '%[0-9]'; -- вернет всех пользователей по условию: username заканчивается любой цифрой
FROM users WHERE email SIMILAR TO '%@%.%'; --проверим, что в поле email введены корректные адреса электронной почты.
FROM users WHERE email NOT SIMILAR TO '%@%.%'; -- частица NOT позволит найти строки, которые не соответствуют шаблону
FROM users WHERE email SIMILAR TO '%@%.__' -- Символ подчеркивания обозначает ровно один любой символ, необязательно букву
FROM users WHERE email SIMILAR TO '%.___'; --

-- упражнение к уроку
SELECT first_name, email FROM users WHERE telephone NOT SIMILAR TO '[0-9]{3}';